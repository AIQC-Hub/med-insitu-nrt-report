```{r, t_summary_loc_filter1, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 10, fig.height = 10}
summary_table_original <- netcdf_summary_1({{df}})
summary_table_original_2 <- netcdf_summary_2(summary_table_original)

{{df_filtered_name}} <- filer_locations({{df}})

summary_table_filtered1 <- netcdf_summary_1({{df_filtered_name}})
summary_table_filtered1_2 <- netcdf_summary_2(summary_table_filtered1)

```

### Filtering criteria

 - **Longitude range**: `r r_min_lon` to `r r_max_lon`
 - **Latitude range**: `r r_min_lat` to `r r_max_lat`

### Mapped locations of all profiles and filtering effects

```{r, t_summary_loc_filter2, echo = FALSE, message = FALSE, warning = FALSE, fig.width = 10, fig.height = 10}
lat_range <- range(summary_table_original$latitude)
lon_range <- range(summary_table_original$longitude)
p_loc_original <- summary_table_original %>%
 create_region_scatter("Original data", lat_range, lon_range)

lat_range <- range(summary_table_filtered1$latitude)
lon_range <- range(summary_table_filtered1$longitude)
p_loc_filter1 <- summary_table_filtered1 %>%
 create_region_scatter("Filtered data", lat_range, lon_range)

print(plot_grid(p_loc_original, p_loc_filter1, nrow = 2))

```

### Counts of the original data

 - **Number of platform**: `r formatC(nrow(summary_table_original_2), big.mark=",")`
 - **Number of profiles**: `r formatC(sum(summary_table_original_2$profile_count), big.mark=",")`
 - **Number of observations**: `r formatC(sum(summary_table_original_2$obs_count), big.mark=",")`

### Counts after filtering

 - **Number of platform**: `r formatC(nrow(summary_table_filtered1_2), big.mark=",")`
 - **Number of profiles**: `r formatC(sum(summary_table_filtered1_2$profile_count), big.mark=",")`
 - **Number of observations**: `r formatC(sum(summary_table_filtered1_2$obs_count), big.mark=",")`
