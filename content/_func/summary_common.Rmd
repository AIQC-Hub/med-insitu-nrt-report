```{r, func_summary_common, message = FALSE, warning = FALSE}

format_netcdf_summary_2 <- function(df) {
  df %>%
    select(`Platform` = 1, `# Profiles` = 2, From = 3, To = 4,
           `# Observations` = 5, `Lon` = 6, `Lat` = 7)
}

create_sample_time_hist <- function(df, title) {
  ggplot(df, aes(x=x)) +
    geom_histogram(stat="count") +
    labs(title = title,
         x = NULL,
         y = "count") + theme_pubr(base_size = 12) +
    theme(axis.text.x = element_text(angle = 45, hjust = 1))
}

create_obs_count_hist <- function(df, title) {
  ggplot(df, aes(obs_count)) +
    geom_histogram() +
    ggtitle(title) +
    xlab("Observation counts by profile") +
    theme_pubr(base_size = 12)
}

create_region_hist <- function(df, title, xtitle) {
  ggplot(df, aes(x)) +
    geom_histogram() +
    ggtitle(title) +
    xlab(xtitle) +
    theme_pubr(base_size = 12)
}

create_region_scatter <- function(df, title, lat_range, lon_range) {
  if (nrow(df) < 5000) {
    nbins <- 500
  } else {
    nbins <- 1000
  }

  ggplot(df, aes(x = longitude, y = latitude)) +
    borders("world", fill = "lightgray", color = "gray") +
    geom_hex(bins = nbins) +
    ggtitle(title) +
    xlab("Longitude") +
    ylab("Latitude") +
    coord_cartesian(xlim = lon_range, ylim = lat_range) +
    theme_pubr(base_size = 12)
}

```
