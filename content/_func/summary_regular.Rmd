```{r, func_summary_regular, message = FALSE, warning = FALSE}

netcdf_summary_1 <- function(df) {
  df %>%
    group_by(platform_code, profile_no) %>%
    summarise(obs_count = n(), profile_timestamp = first(profile_timestamp),
              longitude = first(longitude), latitude = first(latitude)) %>%
    ungroup()
}

netcdf_summary_2 <- function(df) {
  df  %>%
    group_by(platform_code) %>%
    summarise(profile_count = n(),
              min_profile_timestamp = min(profile_timestamp),
              max_profile_timestamp = max(profile_timestamp),
              obs_count = sum(obs_count),
              longitude = first(longitude), latitude = first(latitude),
              min_longitude = min(longitude), max_longitude = max(longitude),
              min_latitude = min(latitude), max_latitude = max(latitude)) %>%
    ungroup() %>%
    mutate(min_profile_timestamp = format(min_profile_timestamp, "%Y-%m"),
           max_profile_timestamp = format(max_profile_timestamp, "%Y-%m"))
}

netcdf_loc_summary <- function(df) {
  df %>% mutate(d_lon = max_longitude - min_longitude,
                d_lat = max_latitude - min_latitude) %>%
          dplyr::select(`Platform` = platform_code,
                        `# Profiles` = profile_count,
                        `Min(Lon)` = min_longitude,
                        `Max(Lon)` = max_longitude,
                        `Diff(Lon)` = d_lon,
                        `Min(Lat)` = min_latitude,
                        `Max(Lat)` = max_latitude,
                        `Diff(Lat)` = d_lat) %>%
    arrange(desc(`Diff(Lon)`))
}

get_loc_by_platform <- function(df, platform) {
  df %>% filter(platform_code == platform)
}

get_loc_by_timespan <- function(lst, timespan){
  lst %>% pluck(timespan)
}

```
