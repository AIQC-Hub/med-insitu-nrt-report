```{r, func_summary_precise, message = FALSE, warning = FALSE}

netcdf_summary_1 <- function(df) {
  df %>%
    group_by(platform_code, profile_no) %>%
    summarise(obs_count = n(), profile_timestamp = first(profile_timestamp),
              precise_longitude = first(precise_longitude), longitude = first(longitude),
              precise_latitude = first(precise_latitude), latitude = first(latitude)) %>%
    ungroup()
}

netcdf_summary_2 <- function(df) {
  df  %>%
    group_by(platform_code) %>%
    summarise(profile_count = n(),
              min_profile_timestamp = min(profile_timestamp),
              max_profile_timestamp = max(profile_timestamp),
              obs_count = sum(obs_count),
              longitude = first(longitude), latitude = first(latitude),
              min_precise_longitude = min(precise_longitude), max_precise_longitude = max(precise_longitude),
              min_precise_latitude = min(precise_latitude), max_precise_latitude = max(precise_latitude)) %>%
    ungroup() %>%
    mutate(min_profile_timestamp = format(min_profile_timestamp, "%Y-%m"),
           max_profile_timestamp = format(max_profile_timestamp, "%Y-%m"))
}

netcdf_loc_summary <- function(df) {
  df %>% mutate(d_lon = max_precise_longitude - min_precise_longitude,
                d_lat = max_precise_latitude - min_precise_latitude) %>%
          dplyr::select(`Platform` = platform_code,
                        `# Profiles` = profile_count,
                        `Min(Lon)` = min_precise_longitude,
                        `Max(Lon)` = max_precise_longitude,
                        `Diff(Lon)` = d_lon,
                        `Min(Lat)` = min_precise_latitude,
                        `Max(Lat)` = max_precise_latitude,
                        `Diff(Lat)` = d_lat) %>%
    arrange(desc(`Diff(Lon)`))
}

get_loc_by_platform <- function(df, platform) {
  df %>% filter(platform_code == platform) %>%
          mutate(longitude = precise_longitude,
                 latitude = precise_latitude)
}

get_loc_by_timespan <- function(lst, timespan){
  lst %>% pluck(timespan) %>%
          mutate(longitude = precise_longitude,
                 latitude = precise_latitude)
}

```
